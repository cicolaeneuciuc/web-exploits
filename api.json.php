<?php
include("db.php");
include("functions.php");
if(!isset($_GET["category"])){
     $result=$conn->query("SELECT *FROM news");
    $vulnerabilities=array();
    while($row=$result->fetch()){
        array_push($vulnerabilities,$row);
    }
    echo json_encode($vulnerabilities);
}else{
    if(!in_array($_GET["category"],$categories)){//Verific daca categoria dorita se afla in lista de categorii posibile
        die(json_encode(array("success"=>false,"reason"=>"Invalid category parameter!")));
    }
    
    $result=$conn->query("SELECT *FROM news where category='".$_GET["category"]."'");
    $vulnerabilities=array();
    while($row=$result->fetch()){
        array_push($vulnerabilities,$row);
    }
    echo json_encode($vulnerabilities);
}
?>