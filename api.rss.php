<?php header('Content-Type: text/xml');
if(!isset($_GET["category"])){
    $_GET["category"]="";
}
echo '<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">';
?>

<channel>
<title>Vulnerabilities Alert RSS Feed for <?php echo $_GET["category"]; ?></title>
<link>https://www.exploit-db.com</link>
<atom:link href="https://www.exploit-db.com/rss-type/?p=1" rel="self" type="application/rss+xml"/>
<language>en-us</language>
<description>RSS feed for dos exploits</description>
<pubDate><?php echo date("r"); ?></pubDate>
<lastBuildDate><?php echo date("r"); ?></lastBuildDate>
<copyright/>



<?php
include("db.php");
include("functions.php");
if(!isset($_GET["category"]) || trim($_GET["category"])==""){
     $result=$conn->query("SELECT *FROM news");
    $vulnerabilities=array();
    while($row=$result->fetch()){
        ?>
        
        <item>
<title>
<?php echo $row["titlu"]; ?>
</title>
<link><?php echo $row["link"]; ?></link>

<pubDate><?php echo $row["date_row"]; ?></pubDate>
<guid isPermaLink="true"><?php echo $row["link"]; ?></guid>
</item>

        <?php
    }

}else{
    if(!in_array($_GET["category"],$categories)){
        die(json_encode(array("success"=>false,"reason"=>"Invalid category parameter!")));
    }
    
    $result=$conn->query("SELECT *FROM news where category='".$_GET["category"]."'");
    $vulnerabilities=array();
    while($row=$result->fetch()){
        ?>
        <item>
<title>
<?php echo $row["titlu"]; ?>
</title>
<link><?php echo $row["link"]; ?></link>

<pubDate><?php echo $row["date_row"]; ?></pubDate>
<guid isPermaLink="true"><?php echo $row["link"]; ?></guid>
</item>
        <?php
    }
    
}
?>
</channel>
</rss>